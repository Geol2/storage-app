<?php

use App\Helpers\Csp;

?>

<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Zero Storage</title>

        <meta charset="UTF-8" />
        <meta http-equiv="Content-Security-Policy"
              content="default-src 'self';
              img-src 'self';
              script-src 'self' 'nonce-{{ Csp::csp_token()  }}' https://code.jquery.com;
              font-src 'self' fonts.gstatic.com;
              style-src 'self' fonts.googleapis.com;
              form-action 'self'">
        <meta http-equiv="pragma" content="no-cache"/>
        <meta http-equiv="Expires" content="0"/>
        <meta http-equiv="Cache-Control" content="no-cache"/>
        <meta name="csrf-token" content="{{ csrf_token() }}" />

        <meta property="og:type" content="website">
        <meta property="og:image" content="/img/zerosoft-logo.png">
        <meta property="og:site_name" content="Zero Storage">
        <meta property="og:description" content="ZeroSoft 파일 저장소">

        <link rel="favicon" href="/favicon.ico">
        <link rel="stylesheet" href="/css/common.css" />
        <link rel="stylesheet" href="/css/header.css" />
        <link rel="stylesheet" href="/css/sidenav.css" />
        <link rel="stylesheet" href="/css/bucket.css" />
        <link rel="stylesheet" href="/css/folder.css" />
        <link rel="stylesheet" href="/css/login.css" />
        <link rel="stylesheet" href="/css/dialog.css" />

        <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap" rel="stylesheet">
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"
                nonce="{{ $_SERVER['CSP_TOKEN'] }}"
                crossorigin="anonymous"></script>
    </head>

    <body class="flex-wrap">
        <div class="header-container">
            <div class="logo">
                <span class="roboto">Z</span>
            </div>

            <div class="flex center">
                <span class="roboto">
                    <a class="main-name" href="/">Zero Storage</a>
                </span>
            </div>

            <div class="left noto-sans-kr">
                @if( !empty($login) )
                    <a class="header-a" id="logout">로그아웃</a>
                @else
                    <a class="header-a" id="login">로그인</a>
                @endif
            </div>

            <div id="spinner">
                <img src="/img/spinner.gif" alt="use spinner"/>
            </div>
        </div>

        <script type="text/javascript" nonce="{{ $_SERVER['CSP_TOKEN']  }}">
            @if( !empty($login) )
            let logoutElement = document.getElementById("logout");

            logoutElement.addEventListener('click', function () {
                logout();
            });

            function logout() {
                spinner.style.display = 'block';

                setTimeout(() => {
                    spinner.style.display = 'none';
                    location.href = '/logout';
                }, 500);
            }
            @else
            let loginElement = document.getElementById("login");

            loginElement.addEventListener('click', function () {
                login();
            });

            function login() {
                spinner.style.display = 'block';

                setTimeout(() => {
                    spinner.style.display = 'none';
                    location.href = '/';
                }, 500);
            }
            @endif
        </script>